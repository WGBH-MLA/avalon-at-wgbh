{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf3 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _reactBootstrap = require(\"react-bootstrap\");\n\nvar _HeadingFormContainer = _interopRequireDefault(require(\"../containers/HeadingFormContainer\"));\n\nvar _TimespanFormContainer = _interopRequireDefault(require(\"../containers/TimespanFormContainer\"));\n\nvar peaksActions = _interopRequireWildcard(require(\"../actions/peaks-instance\"));\n\nvar _alertStatus = require(\"../services/alert-status\");\n\nvar _AlertContainer = _interopRequireDefault(require(\"../containers/AlertContainer\"));\n\nvar _forms = require(\"../actions/forms\");\n\nvar styles = {\n  well: {\n    marginTop: '1rem'\n  }\n};\n\nvar ButtonSection =\n/*#__PURE__*/\nfunction (_Component) {\n  (0, _inherits2[\"default\"])(ButtonSection, _Component);\n\n  function ButtonSection() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, ButtonSection);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = (0, _possibleConstructorReturn2[\"default\"])(this, (_getPrototypeOf2 = (0, _getPrototypeOf3[\"default\"])(ButtonSection)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"state\", {\n      headingOpen: false,\n      timespanOpen: false,\n      initSegment: null,\n      isInitializing: true,\n      alertObj: null,\n      disabled: true\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"setIsInitializing\", function (value) {\n      if (value === 1) {\n        _this.setState({\n          isInitializing: true\n        });\n      } else {\n        _this.setState({\n          isInitializing: false\n        });\n      }\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"clearAlert\", function () {\n      _this.setState({\n        alertObj: null,\n        disabled: true\n      }); // Clear the redux-store flag when closing the alert from AlertContainer\n\n\n      _this.props.handleEditingTimespans(0);\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"handleCancelHeadingClick\", function () {\n      _this.setState({\n        headingOpen: false\n      });\n\n      _this.clearAlert();\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"handleHeadingClick\", function () {\n      _this.props.handleEditingTimespans(1); // When opening heading form, delete if a temporary segment exists\n\n\n      _this.deleteTempSegment();\n\n      _this.setState({\n        alertObj: null,\n        headingOpen: true,\n        timespanOpen: false,\n        disabled: false\n      });\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"handleCancelTimespanClick\", function () {\n      _this.deleteTempSegment();\n\n      _this.setState({\n        timespanOpen: false\n      });\n\n      _this.clearAlert();\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"handleTimeSpanClick\", function () {\n      // Clear existing alertObj\n      _this.clearAlert(); // Disable editing other items in structure\n\n\n      _this.props.handleEditingTimespans(1); // Create a temporary segment if timespan form is closed\n\n\n      if (!_this.state.timespanOpen) {\n        _this.props.createTempSegment();\n      }\n\n      var tempSegment = _this.props.peaksInstance.peaks.segments.getSegment('temp-segment');\n\n      if (tempSegment === null) {\n        _this.setState({\n          alertObj: (0, _alertStatus.configureAlert)(-4, _this.clearAlert),\n          headingOpen: false,\n          disabled: false\n        });\n      } else {\n        // Initialize Redux store with temporary segment\n        _this.props.bindInitSegment(tempSegment, 0);\n\n        _this.setState({\n          initSegment: tempSegment,\n          headingOpen: false,\n          timespanOpen: true,\n          isInitializing: true,\n          disabled: false\n        });\n      }\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"deleteTempSegment\", function () {\n      if (_this.state.initSegment !== null) {\n        _this.props.deleteTempSegment(_this.state.initSegment.id);\n      }\n    });\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(ButtonSection, [{\n    key: \"render\",\n    value: function render() {\n      var timespanFormProps = {\n        cancelClick: this.handleCancelTimespanClick,\n        initSegment: this.state.initSegment,\n        isInitializing: this.state.isInitializing,\n        timespanOpen: this.state.timespanOpen,\n        setIsInitializing: this.setIsInitializing\n      };\n      var _this$props$forms = this.props.forms,\n          editingDisabled = _this$props$forms.editingDisabled,\n          structureRetrieved = _this$props$forms.structureRetrieved,\n          waveformRetrieved = _this$props$forms.waveformRetrieved,\n          streamMediaRetrieved = _this$props$forms.streamMediaRetrieved; // Only return UI when both structure and waveform data exist\n\n      return structureRetrieved && waveformRetrieved ? _react[\"default\"].createElement(\"section\", null, _react[\"default\"].createElement(_AlertContainer[\"default\"], this.state.alertObj), _react[\"default\"].createElement(_reactBootstrap.Row, {\n        \"data-testid\": \"button-row\"\n      }, _react[\"default\"].createElement(_reactBootstrap.Col, {\n        xs: 6\n      }, _react[\"default\"].createElement(_reactBootstrap.Button, {\n        \"data-testid\": \"add-heading-button\",\n        block: true,\n        onClick: this.handleHeadingClick,\n        disabled: this.state.disabled && editingDisabled\n      }, \"Add a Heading\")), _react[\"default\"].createElement(_reactBootstrap.Col, {\n        xs: 6\n      }, _react[\"default\"].createElement(_reactBootstrap.Button, {\n        \"data-testid\": \"add-timespan-button\",\n        block: true,\n        onClick: this.handleTimeSpanClick,\n        disabled: this.state.disabled && editingDisabled || !streamMediaRetrieved\n      }, \"Add a Timespan\"))), _react[\"default\"].createElement(_reactBootstrap.Collapse, {\n        \"in\": this.state.headingOpen\n      }, _react[\"default\"].createElement(\"div\", {\n        className: \"well\",\n        style: styles.well,\n        \"data-testid\": \"heading-form-wrapper\"\n      }, _react[\"default\"].createElement(_HeadingFormContainer[\"default\"], {\n        cancelClick: this.handleCancelHeadingClick\n      }))), _react[\"default\"].createElement(_reactBootstrap.Collapse, {\n        \"in\": this.state.timespanOpen\n      }, _react[\"default\"].createElement(\"div\", {\n        className: \"well\",\n        style: styles.well,\n        \"data-testid\": \"timespan-form-wrapper\"\n      }, _react[\"default\"].createElement(_TimespanFormContainer[\"default\"], timespanFormProps)))) : null;\n    }\n  }]);\n  return ButtonSection;\n}(_react.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    smData: state.smData,\n    peaksInstance: state.peaksInstance,\n    forms: state.forms\n  };\n};\n\nvar mapDispatchToProps = {\n  createTempSegment: peaksActions.insertTempSegment,\n  deleteTempSegment: peaksActions.deleteTempSegment,\n  bindInitSegment: peaksActions.dragSegment,\n  handleEditingTimespans: _forms.handleEditingTimespans\n};\n\nvar _default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(ButtonSection);\n\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"module"}